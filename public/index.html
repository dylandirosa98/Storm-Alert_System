<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Storm Alert Pro - Free Storm Alerts for Roofing Companies</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }

        header {
            text-align: center;
            color: white;
            margin-bottom: 3rem;
            animation: fadeIn 1s ease-out;
        }

        h1 {
            font-size: 3rem;
            margin-bottom: 1rem;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .tagline {
            font-size: 1.3rem;
            opacity: 0.9;
        }

        .form-card {
            background: white;
            border-radius: 20px;
            padding: 3rem;
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
            max-width: 800px;
            margin: 0 auto;
            animation: slideUp 0.8s ease-out;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: #2c3e50;
        }

        input[type="text"],
        input[type="email"],
        input[type="tel"] {
            width: 100%;
            padding: 0.8rem;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }

        input:focus {
            outline: none;
            border-color: #2a5298;
        }

        .states-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 0.5rem;
            max-height: 300px;
            overflow-y: auto;
            padding: 1rem;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            background: #f8f9fa;
            margin-top: 0.5rem;
        }

        .state-checkbox {
            display: flex;
            align-items: center;
            padding: 0.5rem;
            transition: background 0.2s;
            border-radius: 4px;
            background: white;
            margin: 2px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .state-checkbox:hover {
            background: #e9ecef;
        }

        .state-checkbox input {
            margin-right: 0.5rem;
            cursor: pointer;
        }

        .state-checkbox label {
            margin: 0;
            font-weight: normal;
            cursor: pointer;
        }

        .select-all-btn {
            background: #6c757d;
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            cursor: pointer;
            margin-bottom: 0.5rem;
            transition: background 0.3s;
        }

        .select-all-btn:hover {
            background: #5a6268;
        }

        .submit-btn {
            background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%);
            color: white;
            border: none;
            padding: 1rem 3rem;
            font-size: 1.2rem;
            border-radius: 50px;
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
            display: block;
            margin: 2rem auto 0;
            box-shadow: 0 4px 15px rgba(46, 204, 113, 0.3);
        }

        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(46, 204, 113, 0.4);
        }

        .features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
            margin-top: 4rem;
            color: white;
        }

        .feature {
            text-align: center;
            padding: 2rem;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            backdrop-filter: blur(10px);
            transition: transform 0.3s;
        }

        .feature:hover {
            transform: translateY(-5px);
        }

        .feature-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        .success-message {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1rem;
            display: none;
        }

        .error-message {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1rem;
            display: none;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(40px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @media (max-width: 768px) {
            h1 { font-size: 2rem; }
            .form-card { padding: 2rem; }
            .states-grid { grid-template-columns: repeat(auto-fill, minmax(120px, 1fr)); }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>‚õàÔ∏è Storm Alert Pro</h1>
            <p class="tagline">Get instant alerts when storms create roofing opportunities in your service areas</p>
        </header>

        <div class="form-card">
            <div class="success-message" id="successMessage">
                ‚úÖ Success! You'll receive storm alerts for your selected states.
            </div>
            <div class="error-message" id="errorMessage">
                ‚ùå Error: Please fill in all required fields.
            </div>

            <form id="signupForm">
                <div class="form-group">
                    <label for="companyName">Company Name *</label>
                    <input type="text" id="companyName" name="companyName" required>
                </div>

                <div class="form-group">
                    <label for="email">Email Address *</label>
                    <input type="email" id="email" name="email" required>
                </div>

                <div class="form-group">
                    <label for="phone">Phone Number</label>
                    <input type="tel" id="phone" name="phone">
                </div>

                <div class="form-group">
                    <label for="contactName">Contact Name *</label>
                    <input type="text" id="contactName" name="contactName" required>
                </div>

                <div class="form-group">
                    <label>Select States for Storm Alerts *</label>
                    <button type="button" class="select-all-btn" onclick="toggleAllStates()">Select/Deselect All</button>
                    <div class="states-grid" id="statesGrid">
                        <!-- States will be populated by JavaScript -->
                    </div>
                </div>

                <button type="submit" class="submit-btn">Start Receiving Storm Alerts</button>
            </form>
        </div>

        <div class="features">
            <div class="feature">
                <div class="feature-icon">üìç</div>
                <h3>Precise Location Data</h3>
                <p>Get exact zip codes and affected areas for targeted canvassing</p>
            </div>
            <div class="feature">
                <div class="feature-icon">üí∞</div>
                <h3>ROI Analysis</h3>
                <p>Estimated damage severity and potential job value calculations</p>
            </div>
            <div class="feature">
                <div class="feature-icon">‚ö°</div>
                <h3>Real-Time Alerts</h3>
                <p>Instant notifications when storms hit your service areas</p>
            </div>
            <div class="feature">
                <div class="feature-icon">üìä</div>
                <h3>Detailed Reports</h3>
                <p>Comprehensive storm data including wind speed, hail size, and more</p>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const states = [
                'Alabama', 'Alaska', 'Arizona', 'Arkansas', 'California', 'Colorado', 'Connecticut',
                'Delaware', 'Florida', 'Georgia', 'Hawaii', 'Idaho', 'Illinois', 'Indiana', 'Iowa',
                'Kansas', 'Kentucky', 'Louisiana', 'Maine', 'Maryland', 'Massachusetts', 'Michigan',
                'Minnesota', 'Mississippi', 'Missouri', 'Montana', 'Nebraska', 'Nevada', 'New Hampshire',
                'New Jersey', 'New Mexico', 'New York', 'North Carolina', 'North Dakota', 'Ohio',
                'Oklahoma', 'Oregon', 'Pennsylvania', 'Rhode Island', 'South Carolina', 'South Dakota',
                'Tennessee', 'Texas', 'Utah', 'Vermont', 'Virginia', 'Washington', 'West Virginia',
                'Wisconsin', 'Wyoming'
            ];

            const statesGrid = document.getElementById('statesGrid');
            
            // Clear existing content
            statesGrid.innerHTML = '';
            
            // Add states
            states.forEach(state => {
                const div = document.createElement('div');
                div.className = 'state-checkbox';
                div.innerHTML = `
                    <input type="checkbox" id="state-${state}" name="states" value="${state}">
                    <label for="state-${state}">${state}</label>
                `;
                statesGrid.appendChild(div);
            });

            console.log(`Populated ${states.length} states`);
        });

        function toggleAllStates() {
            const checkboxes = document.querySelectorAll('input[name="states"]');
            const allChecked = Array.from(checkboxes).every(cb => cb.checked);
            checkboxes.forEach(cb => cb.checked = !allChecked);
        }

        document.getElementById('signupForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const formData = {
                companyName: document.getElementById('companyName').value,
                email: document.getElementById('email').value,
                phone: document.getElementById('phone').value,
                contactName: document.getElementById('contactName').value,
                states: Array.from(document.querySelectorAll('input[name="states"]:checked'))
                    .map(cb => cb.value)
            };

            if (formData.states.length === 0) {
                showError('Please select at least one state');
                return;
            }

            try {
                const response = await fetch('/api/subscribe', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(formData)
                });

                const data = await response.json();
                
                if (response.ok) {
                    showSuccess();
                    document.getElementById('signupForm').reset();
                } else {
                    showError(data.error || 'Subscription failed. Please try again.');
                    // If it's a duplicate email, highlight the email field
                    if (data.error && data.error.includes('already subscribed')) {
                        const emailInput = document.getElementById('email');
                        emailInput.classList.add('error');
                        emailInput.addEventListener('input', function() {
                            this.classList.remove('error');
                        }, { once: true });
                    }
                }
            } catch (error) {
                console.error('Subscription error:', error);
                showError('Failed to subscribe. Please try again later.');
            }
        });

        function showSuccess() {
            document.getElementById('successMessage').style.display = 'block';
            document.getElementById('errorMessage').style.display = 'none';
            setTimeout(() => {
                document.getElementById('successMessage').style.display = 'none';
            }, 5000);
        }

        function showError(message) {
            const errorEl = document.getElementById('errorMessage');
            errorEl.textContent = `‚ùå Error: ${message}`;
            errorEl.style.display = 'block';
            document.getElementById('successMessage').style.display = 'none';
        }
    </script>
</body>
</html> 